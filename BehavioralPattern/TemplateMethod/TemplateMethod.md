## 模板方法模式 —— TemplateMethod

### 基本认识

模板方法模式（Template Method Pattern）：是对多种事物的 `结构`、`形式`、`行为` 的模板化总结，而模板方法模式则是对一系列类行为（方法）的模式化。

> 模板方法模式（Template Method Pattern）是一种 ​行为型设计模式，它在父类中定义算法的骨架，允许子类在不改变算法结构的情况下重写某些步骤。该模式通过将通用流程固定，差异化步骤延迟到子类实现，实现代码复用与扩展性的平衡。


### 作用/用途
- **封装不变流程**：将算法的核心步骤和顺序固化，避免重复代码。
- **允许步骤定制**：子类可重写特定步骤（如钩子方法），实现灵活扩展。
- **控制扩展点**：父类约束子类的修改范围，防止破坏整体逻辑。
- **减少冗余代码**：通用逻辑在父类实现，子类仅关注差异部分。
​
### 特点
- **好莱坞原则**：“不要调用我们，我们会调用你”——父类控制流程，子类被动填充细节。
- **算法复用**：相同流程的多个变体共享父类代码。
- **扩展受限**：子类只能修改预定义的步骤，无法改变算法结构。
​
### 解决的问题
- **重复代码**：多个类有相似流程，但部分步骤实现不同。
- **流程标准化**：确保算法步骤的执行顺序和核心逻辑一致。
- **扩展与约束的平衡**：允许扩展特定步骤，同时防止破坏整体流程。


### 优缺点
#### 优点：
- 减少重复代码，提升复用性。
- 通过钩子方法提供可控扩展点。

#### 缺点：
- 子类可能被迫实现无关方法（需合理设计抽象方法）。
- 算法结构固化，难以适应剧烈变化的需求。

### 适用场景
- 标准化流程：如数据处理（解析→验证→保存）、UI 渲染（布局→绘制→事件绑定）。
- 框架设计：框架定义操作流程，用户实现具体步骤（如测试框架的 SetUp() → Test() → TearDown()）。
- ​算法变体：多个算法共享大部分逻辑，仅部分步骤不同。

### 实际应用案例
- Go 的 http.Handler：用户实现 ServeHTTP()，框架处理连接管理、超时等。
- 测试框架：定义测试生命周期（Setup() → TestXXX() → Teardown()）。
- 游戏引擎：定义游戏循环（ProcessInput() → Update() → Render()）。


### 用法说明
```bash
# 示例
制作咖啡:
- 煮沸水
- 用沸水冲泡咖啡粉
- 倒入杯子
- 加入牛奶和糖

制作茶:
- 煮沸水
- 用沸水浸泡茶叶
- 倒入杯子  
# 不加料

```

#### 关键点
- ​模板方法：Prepare() 定义了不可变的算法流程。
- ​抽象方法：Brew() 和 AddCondiments() 由子类强制实现。
- ​钩子方法：NeedCondiments() 提供可选扩展点，子类可重写。
- Go 的组合模拟继承：通过嵌入结构体和接口实现多态。