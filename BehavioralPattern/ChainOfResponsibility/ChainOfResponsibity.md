## 责任链模式 —— Chain Of Responsibility

### 基本认识

责任链模式（Chain Of Responsibility Pattern）：允许多个对象按顺序处理同一请求，形成一个处理链路。每一个对象决定是否处理请求或将其传递给链路中的下一个对象，从而实现`请求发送者与接收者的解耦`。

在 Go 语言中，责任链模式通常通过 `函数闭包` 和 `链式调用` 实现，提高代码的灵活性和可扩展性。

### 作用/用途
- **解耦请求与处理**：发送者无需知道具体由哪个对象处理请求。
- **动态调整处理链**：运行时动态添加、删除或调整处理器顺序。
- **多处理器协调**：允许多个对象按优先级一次处理同一个请求（如：审批流程）。
- **简化条件分支**：避免复杂的 `if-else` 或 `switch` 逻辑。

### 特点
- **灵活性**：处理器可按需组合（如：中间件、过滤器）。
- **单一职责原则**：每个处理器只关注自身逻辑。
- **可终止性**：处理器可决定是否终端链的传递。
- **潜在的性能损耗**：长链路可能导致请求遍历多个无效的处理器。

### 解决的问题
- **请求处理逻辑分散**：避免将多个条件判断集中在一个类中。
- **​动态扩展处理逻辑**：新增处理器时无需修改现有代码（开闭原则）。
- **​统一入口**：为多级处理逻辑提供一致的调用接口。

### 关键点
- **链的组装方式**：客户端按需组合处理器顺序（如中间件栈）。
- ​**终止条件**：处理器可自行决定是否中断链（如验证失败）。
- ​**默认实现**：通过 BaseHandler 封装通用链传递逻辑，减少重复代码。
- ​**动态扩展**：支持运行时插入新处理器（如添加缓存检查）。

### 适用场景
- **​多级审批流程**：如报销审批（经理→总监→财务）。
- ​**请求预处理**：如 Web 中间件（日志、压缩、限流）。
- ​**事件处理系统**：如异常处理链（尝试恢复→记录→通知）。
- ​**过滤器链**：如数据清洗（去重→格式校验→标准化）。

### 优缺点
#### 优点：
- 符合单一职责原则，每个处理器职责明确。
- 符合开闭原则，新增处理器无需修改现有代码。
#### 缺点：
- 请求可能未被处理（需兜底机制）。
- 长链可能降低性能（需控制链长度）。
​
### 实际应用案例
- Gin 中间件：通过 Use() 方法添加处理函数链。
- Java Servlet 过滤器：按配置顺序过滤请求和响应。
- 游戏事件处理：如输入事件链（UI→角色→物理引擎）。

