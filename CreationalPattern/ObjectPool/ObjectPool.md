## 对象池模式 —— Object Pool

### 基本认识

对象池模式（Object Pool Pattern）：用于管理一组可重用的对象实例，通过 `复用而非重复创建` 来优化资源消耗。

该模式特别适用于 `初始化成本高` 或 `数量受限的资源`（如：数据库链接、线程、网络连接），在高并发场景中提升性能。

> 对象池模式（Object Pool Pattern）通过预先实例化一定数量的对象(对象池)，在需要时从池中获取对象并在使用完成后将对象归还给池，减少了对象的创建和销毁次数，提高了系统的效率和性能。对象池一般包括初始化、对象获取、对象归还、资源释放等方法，确保对象的有效复用和管理。

### 对象池模式结构
- **对象池（ObjectPool）**：管理和维护一组对象的池实例，提供对象获取、对象归还等方法;
- **对象（Object）**：池中存储的具体对象，可被获取和归还;
- **客户端（Client）**：从对象池中获取对象并进行操作的用户，完成操作后将对象归还给对象池。

### 作用/用途
- **​减少创建开销**：避免频繁创建/销毁对象（如数据库连接）。
- **​控制资源数量**：限制同时使用的对象数量，防止资源耗尽。
- **提升响应速度**：直接从池中获取预初始化对象，减少等待时间。
- **统一管理资源**：集中处理对象的生命周期（如健康检查、超时回收）。

### 特点
- **预初始化**：池启动时预先创建对象，或按需动态扩展。
- **并发安全**：需保证多线程/协程安全获取和释放对象。
- **资源回收**：提供对象复用机制，而非立即销毁。
- **性能与内存权衡**：需平衡池大小和内存占用。

### 解决的问题
- **高成本对象重复创建**：如数据库连接需建立TCP握手、认证等耗时操作。
- **资源泄漏风险**：统一回收机制避免对象未正确释放。
- **系统稳定性**：限制资源使用上限，防止过载。

### 关键点
- **​并发安全**：使用 sync.Mutex 和缓冲通道 (chan) 保证线程安全。
- **​动态扩展**：当池为空但未达上限时，按需创建新连接。
- **​超时控制**：Acquire() 方法支持超时等待，防止无限阻塞。
- **​资源回收策略**：释放时若池已满，可关闭连接而非强制回收。

### 适用场景
- **​高成本资源复用**：如数据库连接、线程、大型内存对象。
- **​高并发请求处理**：需快速响应且资源受限的场景。
- **​资源泄漏防护**：通过统一管理确保对象正确回收。

### 进阶优化
- **​健康检查**：定期检查池中对象是否有效（如心跳检测）。
- **​LRU 淘汰**：释放最久未使用的对象以节省内存。
- **​优雅关闭**：池销毁时正确关闭所有连接。
- **​指标监控**：统计池的使用率、等待时间等指标。
- **​使用 sync.Pool**：对临时对象复用，Go 内置的轻量级池（但生命周期由GC管理）。

### Code
> 见同目录代码