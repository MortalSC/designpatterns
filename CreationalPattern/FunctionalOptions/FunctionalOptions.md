## 函数选项模式 —— Functional Options

### 基本认识

函数选项模式（Functional Options Pattern）：是一种在 Go 语言中广泛使用的 `创建型设计模式`， **用于优雅处理对象构造时的可选参数**。

通过传递一些列 `选项函数（Option Functions）` 来配置对象，避免冗长的构造函数参数列表或复杂的配置结构体。

Option 模式又称傻瓜模式，常常用于参数传递，一般常常与New模式配合使用用于初始化的一个对象的外部参数。

### 作用/用途
- **简化多参数配置**：为对象提供灵活的构造方式，支持可选参数和默认值。
- **提供可读性**：通过命名选项函数（如：`WithTimeout(10)`）明确参数含义。
- **扩展性强**：新增配置选项时，只需添加新的选项函数，**无需修改现有代码**。
- **链式调用**：支持连续调用多个选项函数，简化配置过程。

### 特点
- **零值友好**：未显示设置的参数自动使用默认值。
- **类型安全**：通过函数签名约束选项类型，避免配置错误。
- **符合 Go 习惯**：广泛用于 Go 生态（如：gRPC、HTTP客户端配置）。
> grpc/grpc-go 的 NewServer 函数，uber-go/zap 包的 New 函数都有使用了选项模式。

### 解决的问题
- **​长参数列表**：传统构造函数在参数较多时难以维护（如 NewClient(addr, timeout, retries, ...)）。
- ​**配置结构体膨胀**：避免定义包含所有可能参数的巨型结构体（如 Config 结构体）。
- ​**可选参数缺失**：在 Go 不支持默认参数和重载的情况下，提供优雅的解决方案。

### 关键点
- **选项函数签名**：每个选项函数接收目标对象的指针（如 func(*DBClient)），通过闭包修改其字段。
- ​**可变参数**：构造函数接收 `...Option`，支持传递任意数量的选项。
- **​默认值处理**：构造函数内部初始化默认配置，未设置的选项保持默认。
- **​可读性提升**：通过 `WithXxx` 命名的函数明确参数含义（如 WithTimeout(10)）。

### 适用场景
- 对象构造时包含 ​多个可选参数​（尤其是参数有默认值）。
- 需要 ​高可读性 的配置方式（如 NewClient(WithLogger(), WithTimeout(5))）。
- 希望 ​避免定义配置结构体 或维护长参数列表。

### 实际应用案例
- ​gRPC 客户端配置：grpc.Dial 使用 DialOption 函数选项。
​- HTTP 服务器配置：如 http.Server 的 ReadTimeout 和 WriteTimeout。
​- 日志库：设置日志级别、输出位置等。

### Code
> 见同目录代码